<div class="wrap">
    <div id="detailLoadingOverlay" class="detail-loading-overlay" style="display:none;">
      <div style="display:flex; flex-direction:column; align-items:center; gap:10px;">
        <div class="spinner"></div>
        <div style="color:#9a9a9a; font-weight:900; font-size:12px;">Yükleniyor...</div>
      </div>
    </div>

  <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-6 gap-4">
    <div class="flex items-center gap-4">
      <div class="w-14 h-14 bg-[#0f0f0f] border border-[#2a2a2a] rounded-2xl flex items-center justify-center p-2 overflow-hidden">
        <img id="companyLogo" src="" alt="" class="w-full h-full object-contain hidden" />
        <i id="companyLogoFallback" class="fa-solid fa-building text-2xl text-white"></i>
      </div>

      <div>
        <div class="flex items-center gap-2 mb-1">
          <span id="tickerPill" class="bg-[#1a2205] text-[#c2f50e] border border-[#c2f50e]/30 text-[10px] font-black px-2 py-0.5 rounded uppercase tracking-wide">-</span>
          <span class="text-[10px] font-extrabold text-[#8a8a8a] uppercase tracking-widest">Şirket Detayı</span>
        </div>
        <h1 id="companyTitle" class="text-2xl font-extrabold text-white tracking-tight leading-tight">-</h1>
        <div id="companyMeta" class="text-xs text-[#8a8a8a] font-semibold mt-1">-</div>
      </div>
    </div>

    <div class="flex flex-col items-end gap-3 w-full md:w-auto">
      <div class="flex items-center gap-2 search-wrap">
        <input id="tickerSearch" class="search-input" placeholder="Şirket ara (ticker / isim)" autocomplete="off" />
        <div id="searchDD" class="search-dd"></div>
      </div>

      <div class="text-right">
        <div id="headerPrice" class="text-3xl font-extrabold text-white flex items-center justify-end gap-2">
          <span id="headerCaret" class="hidden text-2xl leading-none"></span>
          <span id="headerPriceVal">-</span>
        </div>
        <div class="font-extrabold text-xs flex items-center justify-end gap-2 mt-1" id="headerChange" style="visibility:hidden;">
          <i id="headerTrendIcon" class="fa-solid fa-arrow-trend-up"></i>
          <span id="headerChangeVal">-</span>
        </div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
    <div class="lg:col-span-8 flex flex-col gap-6">
      <div class="fin-card p-6" id="cardAbout"> <h3 class="text-white font-extrabold text-sm">Hakkında</h3>
        <p class="text-sm text-[#bdbdbd] leading-relaxed mt-4" id="aboutText">-</p>
      </div>

      <div class="fin-card p-5">
        <div class="flex justify-between items-center mb-3 gap-3 flex-wrap">
          <h3 class="text-white font-extrabold text-sm" id="chartTitle">Hisse Fiyatı</h3>
          
          <div class="flex gap-2" id="chartTypeToggle">
            <button class="chart-type-btn active" data-type="area" onclick="setChartType('area')" type="button">Area</button>
            <button class="chart-type-btn" data-type="candlestick" onclick="setChartType('candlestick')" type="button">Mum</button>
          </div>

          <div class="flex gap-2 flex-wrap justify-end" id="rangeBtns" aria-label="Zaman aralığı">
            <button class="range-btn" data-range="1H" onclick="ensureChart('1H')" type="button">1H</button>
            <button class="range-btn" data-range="1A" onclick="ensureChart('1A')" type="button">1A</button>
            <button class="range-btn" data-range="3A" onclick="ensureChart('3A')" type="button">3A</button>
            <button class="range-btn" data-range="6A" onclick="ensureChart('6A')" type="button">6A</button>
            <button class="range-btn active" data-range="1Y" onclick="ensureChart('1Y')" type="button">1Y</button>
            <button class="range-btn" data-range="YTD" onclick="ensureChart('YTD')" type="button">YTD</button>
            <button class="range-btn" data-range="5Y" onclick="ensureChart('5Y')" type="button">5Y</button>
            <button class="range-btn" data-range="MAX" onclick="ensureChart('MAX')" type="button">MAX</button>
          </div>
        </div>
        
        <div id="priceChart" class="-ml-2"></div>
        <div id="volumeChart" class="-ml-2" style="margin-top: 8px; border-top: 1px solid rgba(255,255,255,0.06); padding-top: 8px;"></div>
      </div>

      <div class="fin-card flex flex-col" id="cardFinancials"> 
        <div class="card-head tab-scroll" id="financialTabs" role="tablist" aria-label="Finansal tablolar">
          <div class="tabs-left">
            <button class="tab-btn active" data-tab="ratios" type="button" role="tab" aria-selected="true">Genel Bakış</button>
            <button class="tab-btn" data-tab="income-statement" type="button" role="tab" aria-selected="false">Gelir Tablosu</button>
            <button class="tab-btn" data-tab="balance-sheet" type="button" role="tab" aria-selected="false">Bilanço</button>
            <button class="tab-btn" data-tab="cash-flow-statement" type="button" role="tab" aria-selected="false">Nakit Akış Tablosu</button>
            <button class="tab-btn" data-tab="metrics" type="button" role="tab" aria-selected="false">Detaylı Metrikler</button>
          </div>
          <div class="tabs-right">
            <div class="period-toggle">
              <button id="periodAnnualBtn" class="period-btn active" type="button">Yıllık</button>
              <button id="periodQuarterBtn" class="period-btn" type="button">Çeyreklik</button>
            </div>
          </div>
        </div>

        <div class="overflow-x-auto" id="financialTableWrap">
          <table class="fin-table" aria-label="Finansal tablo">
            <thead>
              <tr id="financialsHeadRow">
                <th width="28%">Kalem</th>
                <th width="16%" data-col="t">TTM</th>
                <th width="16%" id="y1Head">-</th>
                <th width="16%" id="y2Head">-</th>
                <th width="16%" id="y3Head">-</th>
              </tr>
            </thead>
            <tbody id="financialsBody">
              <tr><td colspan="5" style="text-align:center; padding:18px; color:#666; font-weight:900;">Finansallar yükleniyor...</td></tr>
            </tbody>
          </table>
        </div>
        <div id="overviewMetricsCard" style="display:none; padding:16px; border-top:1px solid rgba(255,255,255,.08);">
          <div class="text-[#8a8a8a] text-xs font-extrabold uppercase tracking-widest mb-3">Oranlar</div>
          <div id="overviewMetricsList">
            <div style="text-align:center; padding:18px; color:#666; font-weight:900;">Metrikler yükleniyor...</div>
          </div>
        </div>
      </div>

      <div class="fin-card p-5" id="similarCard">
        <div class="flex justify-between items-center mb-4">
          <span class="text-[#8a8a8a] text-xs font-extrabold uppercase tracking-widest">Benzer Şirketler</span>
        </div>
        <div class="text-xs text-[#6b6b6b] font-semibold mb-3" id="similarSubtitle">-</div>
        <div class="overflow-x-auto">
          <table class="fin-table" aria-label="Benzer şirketler">
            <thead>
              <tr>
                <th width="32%">Şirket</th>
                <th>Market Cap</th>
                <th>Revenue</th>
                <th>Faaliyet Kar Marjı</th>
                <th>F/K</th>
                <th>PD/DD</th>
              </tr>
            </thead>
            <tbody id="similarBody">
              <tr><td colspan="6" style="text-align:center; padding:18px; color:#666; font-weight:900;">Benzerler yükleniyor...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="lg:col-span-4 flex flex-col gap-6">
      <div class="fin-card p-5">
        <div class="flex justify-between items-center mb-5">
          <span class="text-[#8a8a8a] text-xs font-extrabold uppercase tracking-widest">52 Hafta Aralık</span>
          <span class="text-[10px] font-black text-[#6b6b6b] uppercase tracking-widest">Konum</span>
        </div>

        <div class="range-container">
          <div class="range-track" aria-hidden="true">
            <div class="range-fill" id="rangeFill" style="width:0%"></div>
            <div class="range-thumb" id="rangeThumb" style="left:0%">
              <div class="range-label-float" id="currentPriceLabel">-</div>
            </div>
          </div>
        </div>

        <div class="flex justify-between mt-3">
          <div class="text-left">
            <div class="text-[#6b6b6b] text-[10px] font-black uppercase tracking-widest">En Düşük</div>
            <div class="text-white text-sm font-extrabold font-mono" id="lowPrice">-</div>
          </div>
          <div class="text-right">
            <div class="text-[#6b6b6b] text-[10px] font-black uppercase tracking-widest">En Yüksek</div>
            <div class="text-white text-sm font-extrabold font-mono" id="highPrice">-</div>
          </div>
        </div>
      </div>

      <div class="fin-card p-5" id="snapshotCard">
        <div class="flex justify-between items-center mb-4">
          <span class="text-[#8a8a8a] text-xs font-extrabold uppercase tracking-widest">Genel Bilgiler</span>
        </div>

        <div class="text-xs font-black uppercase tracking-widest text-[#8a8a8a] mb-2">Son 4 Dönem: Gelir &amp; Kâr</div>
        <div class="mini-legend">
          <span class="mini-leg-item"><span class="dot rev"></span> Gelir</span>
          <span class="mini-leg-item"><span class="dot prof"></span> Net Kâr</span>
        </div>

        <div class="mini-bars-wrap" id="miniBarsWrap">
          <div style="text-align:center; padding:18px; color:#666; font-weight:900; width:100%;">Finansallar yükleniyor...</div>
        </div>

        <div class="snapshot-grid">
          <div class="snapshot-row"><div class="k">Sektör</div><div class="v" id="sectorVal">-</div></div>
          <div class="snapshot-row"><div class="k">Market Cap</div><div class="v" id="mcapVal">-</div></div>
          <div class="snapshot-row"><div class="k">Kuruluş</div><div class="v" id="foundedVal">-</div></div>
          <div class="snapshot-row"><div class="k">Çalışan</div><div class="v" id="empVal">-</div></div>
          <div class="snapshot-row"><div class="k">Ticker</div><div class="v" id="tickerVal">-</div></div>
        </div>
      </div>

      <div class="fin-card flex flex-col" id="sideStack">
        <div class="card-head">
          <h3 class="text-[#c2f50e] font-black text-xs uppercase tracking-widest">İlgili Haberler</h3>
          <div class="news-filters">
            <button class="news-filter-btn active" data-filter="all">Tümü</button>
            <button class="news-filter-btn" data-filter="positive">Olumlu</button>
            <button class="news-filter-btn" data-filter="negative">Olumsuz</button>
            <button class="news-filter-btn" data-filter="neutral">Nötr</button>
          </div>
        </div>
        <div id="newsList">
          <div class="p-4 text-sm text-[#888] font-semibold">Haberler yükleniyor...</div>
        </div>
        <div class="news-pagination">
          <button id="newsPrevBtn" class="news-page-btn">Önceki</button>
          <span id="newsPageInfo" class="news-page-info">1 / 1</span>
          <button id="newsNextBtn" class="news-page-btn">Sonraki</button>
        </div>
      </div>
    </div>
  </div>
  <div class="h-10"></div>
</div>

<div id="trendModal" class="trend-modal hidden">
  <div class="trend-modal-backdrop"></div>
  <div class="trend-modal-card">
    <div class="trend-modal-head">
      <div class="trend-modal-title" id="trendModalTitle">Trend</div>
      <button class="trend-modal-close" id="trendModalClose" type="button">Kapat</button>
    </div>
    <div id="trendChart" class="trend-chart"></div>
  </div>
</div>


<style>
.chart-type-btn {
  padding: 6px 12px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #fff;
  font-size: 11px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}

.chart-type-btn.active {
  background: rgba(194,245,14,0.12) !important;
  border-color: rgba(194,245,14,0.4) !important;
  color: #c2f50e !important;
}

#financialTabs {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.tabs-left {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
.tabs-right {
  margin-left: auto;
  display: flex;
  align-items: center;
}

.news-filters {
  display: flex;
  gap: 6px;
  margin-left: auto;
}
.news-filter-btn {
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.12);
  color: #bdbdbd;
  font-size: 10px;
  font-weight: 800;
  text-transform: uppercase;
  background: transparent;
}
.news-filter-btn.active {
  color: #c2f50e;
  border-color: rgba(194,245,14,0.4);
  background: rgba(194,245,14,0.12);
}
.news-pagination {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 10px 16px 14px;
  border-top: 1px solid rgba(255,255,255,0.06);
}
.news-page-btn {
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.1);
  background: rgba(255,255,255,0.05);
  color: #d0d0d0;
  font-size: 11px;
  font-weight: 800;
}
.news-page-info {
  color: #8a8a8a;
  font-size: 11px;
  font-weight: 900;
}

.trend-modal {
  position: fixed;
  inset: 0;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}
.trend-modal.hidden {
  display: none;
}
.trend-modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.6);
}
.trend-modal-card {
  position: relative;
  width: min(720px, 94vw);
  background: #0f0f0f;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
  padding: 16px;
  z-index: 2;
}
.trend-modal-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.trend-modal-title {
  font-size: 14px;
  font-weight: 900;
  color: #fff;
}
.trend-modal-close {
  padding: 6px 10px;
  border-radius: 8px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  color: #cfcfcf;
  font-size: 11px;
  font-weight: 800;
}
.trend-chart {
  height: 260px;
}

.period-toggle {
  display: inline-flex;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  padding: 2px;
  gap: 2px;
}
.period-btn {
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 10px;
  font-weight: 800;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #bdbdbd;
  background: transparent;
  border: none;
  cursor: pointer;
}
.period-btn.active {
  background: rgba(194,245,14,0.14);
  color: #c2f50e;
}
.period-btn.disabled,
.period-btn:disabled {
  opacity: 0.45;
  cursor: not-allowed;
}
.fin-table th,
.fin-table td {
  white-space: nowrap;
}
.fin-table th.period-col {
  min-width: 96px;
}
.fin-row {
  cursor: pointer;
}

.range-btn {
  padding: 6px 10px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #fff;
  font-size: 10px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 38px;
}

.range-btn.active {
  background: rgba(194,245,14,0.15);
  border-color: #c2f50e;
  color: #c2f50e;
}

#volumeChart:empty {
  display: none;
}
</style>
